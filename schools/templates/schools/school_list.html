{% extends "header.html" %}

{% block content %}
    <div>
        <div class="map-container">
            <div id="main-map"></div>
        </div>
    </div>

    <script type="text/javascript">

        var mymap = L.map('main-map').setView([1.32, 103.83], 12);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?{foo}', {
            foo: 'bar',
            minZoom: 12,
            maxZoom: 17,
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
        }).addTo(mymap);
        //set map map.setMaxBounds
        mymap.setMaxBounds([[1.1, 103.5], [1.5, 104.2]]);
        //create markers group
        var markers = L.layerGroup();

        {% for school in primary_school_list %}
            var lon = "{{ school.geometry.x }}";
            var lat = "{{ school.geometry.y }}";
            // add a marker to markers
            var marker = L.marker([lat, lon]).bindPopup('This is {{ school.name }}');
            markers.addLayer(marker);
        {% endfor %}

        //add markers group to map
        mymap.addLayer(markers);

        //alert mouse location on click
        mymap.addEventListener('click', function (ev) {
            var lat, lng;
            lat = ev.latlng.lat;
            lng = ev.latlng.lng;
            alert(lat + ' - ' + lng);
            markers.clearLayers();
            marker = L.marker([lat, lng]);
            markers.addLayer(marker);
        });
    
    </script>
{% endblock %}