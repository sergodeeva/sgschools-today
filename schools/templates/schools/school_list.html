{% extends "header.html" %}
{% load static %}
{% block content %}
    <div class="page-wrapper page">
        <div class="map-container page">
            <div id="main-map"></div>
        </div>
    </div>

    <script src="{% static "schools/js/init_map.js" %}"></script>
    <script src="{% static "schools/js/map_function.js" %}"></script>
    <script type="text/javascript">

        var schools_json = {{ schools_list|safe }};

        //schools_json from Django view
        var schools_list = schools_json.features;

        show_schools(schools_list);


        {#        {% for school in schools_list %}#}
        {#            var lng = '{{ school.geometry.x }}';#}
        {#            var lat = '{{ school.geometry.y }}';#}
        {#            // create popup contents#}
        {#            var customPopup = '<b>{{ school.name }}</b><br/>';#}
        {#            {% for k in school.kindergarten_set.all %}#}
        {#                customPopup += '{{ k.name }}</br>';#}
        {#            {% endfor %}#}
        {#            customPopup += '<button type="button" class="popup-btn circle btn btn-info"  data-toggle="button">circle</button>';#}
        {##}
        {#            {% if school.kindergarten_set.all %}#}
        {#                customPopup += '<button type="button" class="popup-btn show-kindergarten btn btn-info">show</button>';#}
        {#            {% endif %}#}
        {#            // add a marker to group#}
        {#            marker = L.marker([lat, lng], {icon: schoolMarker}).bindPopup(customPopup, customOptions);#}
        {#            schools.addLayer(marker);#}
        {#        {% endfor %}#}
        {##}
        {#        {% for kindergarten in kindergarten_list %}#}
        {#            lng = '{{ kindergarten.geometry.x }}';#}
        {#            lat = '{{ kindergarten.geometry.y }}';#}
        {#            customPopup = '<b>{{ kindergarten.name }}</b><br/>';#}
        {#            {% for ps in kindergarten.primary_schools.all %}#}
        {#                customPopup += '{{ ps.name }}</br>';#}
        {#            {% endfor %}#}
        {#            customPopup += '<button type="button" class="circle btn btn-info">circle</button>';#}
        {##}
        {##}
        {#            // add a marker to group#}
        {#            var marker = L.marker([lat, lng], {icon: kindergartenMarker}).bindPopup(customPopup, customOptions);#}
        {#            kindergartens.addLayer(marker);#}
        {#        {% endfor %}#}

        //alert mouse location on click
        mymap.addEventListener('', function (ev) {
            var lat, lng;
            lat = ev.latlng.lat;
            lng = ev.latlng.lng;
            alert(lat + ' - ' + lng);
        });

    </script>

{% endblock %}